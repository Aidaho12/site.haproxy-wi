{% extends "base.html" %}
{% block content %}	
<div style="padding-left: 20px">
	<ul class="link_list">
		<li><a href="installation.py#rpm" title="RPM installation">RPM installation</a></li>
		<li><a href="installation.py#why" title="RPM installation">Why should I use RPM?</a></li>
		<li><a href="installation.py#manual" title="Manual installation">Manual installation</a></li>
		<li><a href="installation.py#ansible" title="Ansible installation">Ansible installation</a></li>
		<li><a href="installation.py#selinux" title="Installing SELinux policy">Installing SELinux policy</a></li>
		<li><a href="installation.py#fail2ban" title="Installing Fail2ban">Installing Fail2ban</a></li>
		<li><a href="installation.py#os" title="OS support">OS support</a></li>
	</ul>
	<a name="rpm"></a>
	<h3><a href="installation.py#rpm" title="RPM installation">RPM</a></h3>	
	<br />
	You may retrieve signed binary configuration files from link. It may be automatically installed by root thus: 
	
	<div class="code_div">
		<pre>
$ sudo yum install https://repo.haproxy-wi.org/haproxy-wi-release-7-1-0.noarch.rpm 

or

$ sudo yum install https://repo1.haproxy-wi.org/haproxy-wi-release-7-1-0.noarch.rpm 
		</pre>
	</div>
	
	Set up your credentials:
		<div class="code_div">
		<pre>
$ sudo vi /etc/yum.repos.d/haproxy-wi.repo
		</pre>
	</div>
	And add your credentials:
			<div class="code_div">
		<pre>
baseurl = http://login:password@repo.haproxy-wi.org/el$releasever/
		</pre>
	</div>

	Install extra repository:
	<div class="code_div">
		<pre>
$ sudo yum install epel-release
		</pre>
	</div>
	If you use CentOS 7 also install next:
	<div class="code_div">
		<pre>
$ sudo yum install https://repo.ius.io/ius-release-el7.rpm
		</pre>
	</div>

	And install HAProxy-WI:
	<div class="code_div">
		<pre>
$ sudo yum install haproxy-wi haproxy-wi-selinux
		</pre>
	</div>
	<h4>Open in your broweser: https://your_ip/ Default login/password are: admin/admin</h4>
<b>Before uses RPM repository you should donate to support project on <a href="https://www.patreon.com/haproxy_wi/overview" title="Patreon" target="_blank">Patreon</a> 
or on <a href="https://www.paypal.me/loginovpavel" title="PayPal" target="_blank">PayPal</a> and I will send you credentials for access. 
Actual prices you can see on <a href="https://www.patreon.com/haproxy_wi/overview" title="Patreon" target="_blank">Patreon</a>. But you can donate as many as you can or as you want. Please indicate the purpose of the donation, if any.</b>
	<br /><br />
	Do you <a href="https://haproxy-wi.org/#try" title="Try">want to try free</a>? No problem, just 
	<a hrer="#" title="Get trial period" id="redis" onclick="redis()" style="cursor: pointer"> fill the form</a> or <a href="https://haproxy-wi.org/contacts.py" title="Contacts">write</a> to us
	and you will get access for a week!

	<br /><br />
	<a name="why"></a>
	<h3><a href="installation.py#rpm" title="RPM installation">Why should I use RPM?</a></h3>	
	<br />
	Using RPM it is the best solution because:
	<ul class="link_list">
		<li>It is more convenient: just type one command for installation</li>
		<li>Updating without any problems: update with a one command or click a one button in the Web Interface</li>
		<li>More stable and less bugs: RPM releases after community tests</li>
		<li>Use RPM you help project to grow and evolve</li>
		<li>It is safer: you do not need disable SELinux and firewall</li>
	</ul>
	
	<a name="manual"></a>
	<h3><a href="installation.py#manual" title="Manual installation">Manual</a></h3>
	<div class="code_div">
		<pre>
$ cd /var/www/
$ git clone https://github.com/Aidaho12/haproxy-wi.git /var/www/haproxy-wi		
		
<b>CentOS 7:</b>

$ sudo yum install https://repo.ius.io/ius-release-el7.rpm
$ sudo yum -y install git nmap-ncat net-tools dos2unix python3 python3-pip  \
python36-ldap3 python36-pytz python36-requests  python36-future \
python36-jinja2 python36-bottle python-configparser python36-mod_wsgi \
httpd mod_ssl rsync ansible
$ pip3 install -r haproxy-wi/config_other/requirements_el7.txt

<b>CentOS 8:</b>

$ sudo yum -y install python36 python3-pip python36-devel dos2unix httpd mod_ssl python3-mod_wsgi \
nmap-ncat net-tools lshw python3-ldap rsync ansible
$ pip3 install -r haproxy-wi/config_other/requirements_el8.txt

<b>Both CentOS:</b>

$ sudo cp haproxy-wi/config_other/httpd/* /etc/httpd/conf.d/

<b>Or if you use Debian/Ubuntu:</b>

$ sudo apt-get install git net-tools lshw dos2unix apache2 libapache2-mod-wsgi-py3 \
python3-pip g++ freetype2-demos libatlas-base-dev apache2-ssl-dev netcat python3 \
python3-ldap libpq-dev python-dev libpython-dev libxml2-dev libxslt1-dev libldap2-dev \
libsasl2-dev libffi-dev python3-dev libssl-dev gcc rsync ansible  -y
$ chown -R www-data:www-data haproxy-wi/
$ sudo cp haproxy-wi/config_other/httpd/* /etc/httpd/available-sites/
$ sudo a2ensite haproxy-wi.conf
$ sudo a2enmod cgid
$ sudo a2enmod ssl
$ pip3 install -r haproxy-wi/requirements.txt

<b>Both</b>

$ chmod +x haproxy-wi/app/*.py 
$ sudo cp haproxy-wi/config_other/logrotate/* /etc/logrotate.d/
$ sudo cp haproxy-wi/config_other/syslog/* /etc/rsyslog.d/
$ sudo cp haproxy-wi/config_other/systemd/* /etc/systemd/system/
$ sudo systemctl daemon-reload      
$ sudo systemctl restart httpd
$ sudo systemctl restart rsyslog
$ sudo systemctl restart metrics_haproxy.service
$ sudo systemctl restart checker_haproxy.service
$ sudo systemctl restart keep_alive.service
$ sudo systemctl enable metrics_haproxy.service
$ sudo systemctl enable checker_haproxy.service
$ sudo systemctl enable keep_alive.service
$ sudo mkdir /var/www/haproxy-wi/app/certs
$ sudo mkdir /var/www/haproxy-wi/keys
$ sudo mkdir /var/www/haproxy-wi/configs/
$ sudo mkdir /var/www/haproxy-wi/configs/hap_config/
$ sudo mkdir /var/www/haproxy-wi/configs/kp_config/
$ sudo mkdir /var/www/haproxy-wi/configs/nginx_config/
$ sudo mkdir /var/www/haproxy-wi/log/
$ chown -R apache:apache /var/www/haproxy-wi/

<b>If you use Debian/Ubuntu:</b>

Change httpd to apache2 PATH and apache to www-data user in the all configs
		</pre>
	</div>
	<br />
	And create DB:
	<div class="code_div">
		<pre>
$ cd /var/www/haproxy-wi/app
$ ./create_db.py
		</pre>
	</div>
	Disable SELinux and enjoy!
	<h4>Open in your broweser: https://your_ip/ Default login/password are: admin/admin</h4>
<a name="ansible"></a>
	<h3><a href="installation.py#ansible" title="Ansible install">Ansible install</a></h3>	
	<br />
	 If you use RPM you have not to do anything. HAProxy-WI will install and configure Ansible properly. For manual installation you should do next: 
	<div class="code_div">
		<pre>
$ sudo mkdir /usr/share/httpd/.ansible
$ sudo touch /usr/share/httpd/.ansible_galaxy
$ sudo mkdir /usr/share/httpd/.ssh
$ sudo chown apache:apache /usr/share/httpd/.*
$ sudo echo "apache          ALL=(ALL)       NOPASSWD: ALL" >> /etc/sudoers

<b>Or if use Debian/Ubuntu:</b>

$ sudo mkdir /usr/share/apache2/.ansible
$ sudo touch /usr/share/apache2/.ansible_galaxy
$ sudo mkdir /usr/share/apache2/.ssh
$ sudo chown apache:apache /usr/share/httpd/.*
$ sudo echo "www-data          ALL=(ALL)       NOPASSWD: ALL" >> /etc/sudoers
		</pre>
	</div>
	Disable SELinux and enjoy!
	<br />
	<br />
<a name="selinux"></a>
	<h3><a href="installation.py#selinux" title="Installing SELinux policy">Installing SELinux policy</a></h3>	
	<br />
	If you use RPM you have not do anything. HAProxy-WI will install SELinux policy, if this does not happen then install the package:
	<div class="code_div">
		<pre>
$ sudo yum install haproxy-wi-selinux
		</pre>
	</div>
	<!-- <br /> -->
	<!-- For manual installation SELinux policy do next: -->
	<!-- <div class="code_div"> -->
		<!-- <pre> -->
<!-- $ sudo install policycoreutils-python- -->
<!-- # semanage boolean -m --on httpd_can_network_connect_db -->
<!-- # semanage boolean -m --on httpd_enable_cgi -->

<!-- # semanage fcontext -a -t httpd_unconfined_script_exec_t "/var/www/haproxy-wi/app(/.*)?" -->
<!-- # restorecon -r /var/www/haproxy-wi/app/ -->
		<!-- </pre> -->
	<!-- </div> -->
	
	<!-- Or just disabled SELinux :) -->
	<br />
	<a name="fail2ban"></a>
	<h3><a href="installation.py#fail2ban" title="Installing fail2ban policy">Installing Fail2ban</a></h3>	
	<br />
	If you use RPM you have not do anything. HAProxy-WI will install Fail2ban. For manual installation you should do next:
	<div class="code_div">
		<pre>
<b>For EL:</b>
$ sudo yum install fail2ban

<b>For Debian/Ubuntu:</b>
$ sudo apt-get install fail2ban
		</pre>
	</div>
	After installation you should copy config files:
	<div class="code_div">
		<pre>
$ sudo cp /var/www/haproxy-wi/config_other/fail2ban/filter.d/* /etc/fail2ban/filter.d/
$ sudo cp /var/www/haproxy-wi/config_other/fail2ban/jail.d/* /etc/fail2ban/jail.d/
		</pre>
	</div>	
	Enable and start the services:
	<div class="code_div">
		<pre>
$ sudo systemctl start fail2ban
$ sudo systemctl enable fail2ban
		</pre>
	</div>	
	<br />
		<a name="os"></a>
	<h3><a href="installation.py#os" title="OS support">OS support</a></h3>	
	<br />
	HAProxy-WI supports next os:
	<ul class="link_list">
		<li>EL7(RPM installation and manual installation)</li>
		<li>EL8(RPM installation and manual installation)</li>
		<li>Other Unix(only manual installation)</li>
	</ul>
</div>
{% endblock %}
